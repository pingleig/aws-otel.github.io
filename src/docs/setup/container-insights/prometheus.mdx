---
title: 'Container Insights Prometheus'
description:
    TODO container insight prometheus doc.
path: '/docs/setup/container-insights/prometheus'
---

import SectionSeparator from "components/MdxSectionSeparator/sectionSeparator.jsx"
import { Link } from "gatsby"

<SectionSeparator />

CloudWatch Container Insights supports saving and visualizing [Prometheus metrics](https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/ContainerInsights-Prometheus.html)
using [CloudWatch Agent](https://github.com/aws/amazon-cloudwatch-agent).
ADOT collector offers the same experience using Prometheus Receiver and CloudWatch EMF Exporter.

## See Also

- <Link to="/docs/setup/container-insights/eks-prometheus">Container Insights EKS Prometheus</Link>
- <Link to="/docs/setup/container-insights/ecs-prometheus">Container Insights ECS Prometheus</Link>
- [Container Insights Prometheus Official Doc](https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/ContainerInsights-Prometheus.html)

## Supported environments

Similar to [CloudWatch Agent](https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/ContainerInsights-Prometheus.html),
both EKS and ECS are supported using the following components.
ECS requires extension because Prometheus does not have builtin disocvery for ECS (unlike EKS).

| Environment                                                         | Extension    | Receiver   | Exporter       |
|---------------------------------------------------------------------|--------------|------------|----------------|
| <Link to="/docs/setup/container-insights/eks-prometheus">EKS</Link> | N/A          | Prometheus | CloudWatch EMF |
| <Link to="/docs/setup/container-insights/ecs-prometheus">ECS</Link> | ECS Observer | Prometheus | CloudWatch EMF |

## Pre-built dashboards for worklods

CloudWatch console has auto dashboard for workloads listed in following table.

| Environment                                                         | AWS App Mesh | Java JMX | NGINX | NGINX Plus | HAProxy | Memcached |
|---------------------------------------------------------------------|--------------|----------|-------|------------|---------|-----------|
| <Link to="/docs/setup/container-insights/eks-prometheus">EKS</Link> | Y            | Y        | Y     | N          | Y       | Y         |
| <Link to="/docs/setup/container-insights/ecs-prometheus">ECS</Link> | Y            | Y        | Y     | Y          | N       | N         |

- Workload without pre-build dashboard can still send metrics to CloudWatch. However, you need to [build your CloudWatch dashboard manually](https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/create_dashboard.html).
<!-- - items in table link to workload setup instruction. -->

## Export format

Container Insights Prometheus are exported as both log and metrics.
EMF exporter match metrics based on `metrics_selection` config in EMF exporter and uses EMF format for matched metrics.
CloudWatch will extract EMF log to metric automatically and charge accordingly.
You can turn off metric extraction entirely and send all Prometheus metrics as structured log.

Assuming you have a EKS cluster called `eks-1` and a ECS cluster called `ecs-1`.
You will see the following resources in CloudWatch console.
Log group name contains cluster name while Metrics save all clusters under one namespace with different dimension value.

| Environment                                                         | Log group                                     | Metrics Namespace                  |
|---------------------------------------------------------------------|-----------------------------------------------|------------------------------------|
| <Link to="/docs/setup/container-insights/eks-prometheus">EKS</Link> | `/aws/containerinsights/eks-1/prometheus`     | `ContainerInsights/Prometheus`     |
| <Link to="/docs/setup/container-insights/ecs-prometheus">ECS</Link> | `/aws/ecs/containerinsights/ecs-1/prometheus` | `ECS/ContainerInsights/Prometheus` |
